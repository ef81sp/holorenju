## プロジェクト概要

- 連珠学習用ゲーム
- シナリオ内にデモモードと問題モードを持つ
- デモモードではキャラクターが会話しながら連珠の打ち方を解説
- 問題モードではプレイヤーが実際に連珠を打ちながら学習
- シナリオエディタを内蔵

## パッケージマネージャ

- pnpm

## Vue / TypeScript

- 最新の 3.x を使用。記法に注意。公式ドキュメント参照。
- script setup lang="ts" を使用。
  - definePropsではTypeScriptの型定義(ジェネリクスのやつ)を使用。
- 単一責任の原則に従い、コンポーネントを細分化。
- 同じデータ構造（例：character + emotion + text）を持つコンポーネントはUIパターンも統一する
- コンポーネント参照の型定義時は、実際に expose されているメソッド名を確認する。オプショナルチェーン（?.）で安全にメソッド呼び出しを行う
- ダイアログの実装はdialog要素で。既存のコンポーネントを参考に。
- Oxlint / Oxfmt を使っている。Vueプラグインだけeslintを使っている。

### CSS

- 画面サイズは固定のため、レイアウトには相対値を使用。style.cssにsize変数あり、これを必ず使用。rem/px等禁止。
- カラーパレットは:rootに定義。必ず変数を使用。
- 疑似クラスには入れ子セレクタを使用
- フォントの都合上、太字はfont-weight: 500を使用。通常は300
- scoped style はコンポーネント境界を越えて継承されない。ユーティリティクラスはグローバルスタイル（style.css）に定義する
- dialog要素やpopoverの要素に直接display属性を指定してはいけない。標準動作を妨げる。必要の場合は子要素にラッパーをもたせること

## Konva

- Vue Konva を使用。公式ドキュメント参照。

## 開発手順

- docs 配下の markdown に計画と TODO があり、それに従う
- 開発サーバーは常に起動している（起動不要）
- pnpm check-fix を使用。一括実行可能のため、lint/check/fixは使わなくて良い
- 多くとも1ファイル400行程度に留めるのが望ましい。特にSFCは肥大化しやすい。意味の単位で分割を検討する
  - コンポーネントの分割
  - composablesの作成
- 指摘された内容は、一般化してAGENTS.mdに追記。トンマナ揃えること

## 動作確認

- 指示された場合のみ行う
- Playwright MCPが使える
- コンテキスト削減のため、ウィンドウサイズはh540\*w960に固定
- スクショは可能な限り取らない(コンテキストが埋まって詰む)
